<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Process Reengineering Studio | Optimize Your Business Processes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --primary-light: #4895ef;
            --accent: #f72585;
            --accent-dark: #b5179e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #adb5bd;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #f94144;
            --sidebar-bg: #2d3748;
            --canvas-bg: #f7fafc;
            --nav-height: 60px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
            overflow: hidden;
        }
        
        .container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }
        
        /* Top Navigation */
        .top-nav {
            height: var(--nav-height);
            background-color: var(--primary-dark);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            justify-content: space-between;
        }
        
        .nav-left {
            display: flex;
            align-items: center;
        }
        
        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            margin-right: 30px;
        }
        
        .logo i {
            margin-right: 10px;
            color: var(--accent);
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            height: 100%;
        }
        
        .nav-item {
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
            padding: 0 15px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item.has-dropdown::after {
            content: "â–¾";
            margin-left: 8px;
            font-size: 0.8rem;
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            color: var(--dark);
            min-width: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 0 0 5px 5px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .nav-item:hover .dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .dropdown-item:hover {
            background-color: #f5f7fb;
        }
        
        .dropdown-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            color: var(--primary);
        }
        
        .divider {
            height: 1px;
            background-color: #e2e8f0;
            margin: 5px 0;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        /* Canvas Area */
        .canvas-container {
            flex: 1;
            background-color: var(--canvas-bg);
            padding: 20px;
            overflow: auto;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .canvas-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .canvas-title {
            font-size: 1.2rem;
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .canvas-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 15px;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background-color: #f8f9fa;
            border-color: var(--primary-light);
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #3aa8d0;
        }
        
        .process-canvas {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            flex: 1;
            padding: 30px;
            position: relative;
            overflow: auto;
            min-height: 500px;
        }
        
        /* Process Nodes */
        .process-node {
            position: absolute;
            width: 160px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            cursor: move;
            border-left: 4px solid transparent;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .process-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .process-node.start {
            border-left-color: var(--success);
        }
        
        .process-node.decision {
            border-left-color: var(--accent);
            width: 130px;
            height: 130px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transform: rotate(45deg);
        }
        
        .process-node.decision .node-text {
            transform: rotate(-45deg);
        }
        
        .process-node.action {
            border-left-color: var(--primary);
        }
        
        .process-node.end {
            border-left-color: var(--gray);
        }
        
        .node-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-dark);
        }
        
        .node-text {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .node-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--accent);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* Connectors */
        .connector {
            position: absolute;
            background-color: #cbd5e0;
            z-index: 1;
        }
        
        .connector.horizontal {
            height: 2px;
        }
        
        .connector.vertical {
            width: 2px;
        }
        
        .connector-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #cbd5e0;
        }
        
        /* Analysis Panel */
        .analysis-panel {
            width: 350px;
            background-color: white;
            border-left: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .panel-header {
            padding: 20px 20px 0;
        }
        
        .panel-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .panel-tabs {
            display: flex;
            margin-bottom: 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .panel-tab {
            padding: 12px 15px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }
        
        .panel-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .kpi-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .kpi-card {
            background-color: var(--light);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .kpi-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .kpi-label {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .metrics-list {
            list-style: none;
            margin-bottom: 25px;
        }
        
        .metric-item {
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
        }
        
        .metric-label {
            color: var(--gray);
        }
        
        .metric-value {
            font-weight: 600;
            color: var(--dark);
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
        }
        
        .bottleneck-item {
            padding: 15px;
            background-color: #fff5f5;
            border-left: 4px solid var(--danger);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .bottleneck-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .bottleneck-desc {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .improvement-card {
            padding: 15px;
            background-color: #f0f9ff;
            border-left: 4px solid var(--success);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .improvement-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .improvement-desc {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Status Bar */
        .status-bar {
            height: 30px;
            background-color: var(--primary-dark);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            font-size: 0.8rem;
        }
        
        .status-item {
            margin-right: 20px;
            display: flex;
            align-items: center;
        }
        
        .status-item i {
            margin-right: 5px;
            font-size: 0.7rem;
        }
        
        /* Mobile Styles */
        @media (max-width: 992px) {
            .logo {
                font-size: 1.1rem;
                margin-right: 15px;
            }
            
            .nav-item {
                padding: 0 10px;
                font-size: 0.9rem;
            }
            
            .analysis-panel {
                width: 300px;
            }
        }
        
        @media (max-width: 768px) {
            .top-nav {
                padding: 0 15px;
            }
            
            .logo span {
                display: none;
            }
            
            .logo {
                margin-right: 10px;
            }
            
            .mobile-menu-btn {
                display: block;
                margin-right: 15px;
            }
            
            .nav-menu {
                position: fixed;
                top: var(--nav-height);
                left: 0;
                width: 100%;
                background-color: var(--primary-dark);
                flex-direction: column;
                height: auto;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s;
                z-index: 1000;
            }
            
            .nav-menu.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            .nav-item {
                height: auto;
                padding: 15px 20px;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .nav-item.has-dropdown::after {
                margin-left: auto;
            }
            
            .dropdown {
                position: static;
                opacity: 1;
                visibility: visible;
                transform: none;
                box-shadow: none;
                background-color: rgba(0,0,0,0.2);
                color: white;
                display: none;
            }
            
            .dropdown-item {
                color: white;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .dropdown-item:hover {
                background-color: rgba(255,255,255,0.1);
            }
            
            .dropdown-item i {
                color: white;
            }
            
            .nav-item.active .dropdown {
                display: block;
            }
            
            .user-profile span {
                display: none;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .analysis-panel {
                width: 100%;
                height: 40vh;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }
            
            .canvas-container {
                height: 60vh;
            }
            
            .canvas-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .canvas-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .btn span {
                display: none;
            }
            
            .status-bar {
                flex-wrap: wrap;
                height: auto;
                padding: 8px 15px;
            }
            
            .status-item {
                margin-right: 15px;
                margin-bottom: 5px;
            }
            
            .process-node {
                width: 140px;
                padding: 12px;
            }
            
            .process-node.decision {
                width: 110px;
                height: 110px;
            }
            
            .node-title {
                font-size: 0.9rem;
            }
            
            .node-text {
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .logo {
                font-size: 1rem;
            }
            
            .canvas-title {
                font-size: 1rem;
            }
            
            .btn {
                padding: 6px 10px;
            }
            
            .process-node {
                width: 120px;
                padding: 10px;
            }
            
            .process-node.decision {
                width: 90px;
                height: 90px;
            }
            
            .node-title {
                font-size: 0.8rem;
            }
            
            .node-text {
                font-size: 0.7rem;
            }
            
            .kpi-cards {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .panel-content {
                padding: 15px;
            }
        }
        
        /* Animation for node connections */
        @keyframes pulse {
            0% { opacity: 0.4; }
            50% { opacity: 1; }
            100% { opacity: 0.4; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .simulation-results {
            background-color: #f0f9ff;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--success);
        }
        
        .results-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-dark);
            font-size: 1.1rem;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .result-improvement {
            color: var(--success);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-left">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">
                    <i class="fas fa-project-diagram"></i>
                    <span>Process Reengineering</span>
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item has-dropdown">
                        File
                        <div class="dropdown">
                            <div class="dropdown-item">
                                <i class="fas fa-file-import"></i>
                                Import from Text
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-database"></i>
                                Import from ERP
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-cloud-download-alt"></i>
                                Import from Cloud
                            </div>
                            <div class="divider"></div>
                            <div class="dropdown-item">
                                <i class="fas fa-folder-open"></i>
                                Open Project...
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-save"></i>
                                Save Project
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-file-export"></i>
                                Export as... (PDF, PNG, BPMN)
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">Edit</li>
                    <li class="nav-item">View</li>
                    <li class="nav-item has-dropdown">
                        Tools
                        <div class="dropdown">
                            <div class="dropdown-item">
                                <i class="fas fa-magic"></i>
                                Process Optimizer
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-chart-line"></i>
                                Analytics
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-users"></i>
                                Collaboration
                            </div>
                            <div class="divider"></div>
                            <div class="dropdown-item">
                                <i class="fas fa-question-circle"></i>
                                Help & Tutorials
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">Share</li>
                </ul>
            </div>
            <div class="user-profile">
                <div class="avatar">JS</div>
                <span>John Smith</span>
                <i class="fas fa-chevron-down"></i>
            </div>
        </nav>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Canvas Area -->
            <div class="canvas-container">
                <div class="canvas-header">
                    <div class="canvas-title">PROCESS REENGINEERING CANVAS</div>
                    <div class="canvas-actions">
                        <button class="btn">
                            <i class="fas fa-undo"></i>
                            <span>Undo</span>
                        </button>
                        <button class="btn">
                            <i class="fas fa-redo"></i>
                            <span>Redo</span>
                        </button>
                        <button class="btn btn-primary" id="simulateBtn">
                            <i class="fas fa-play"></i>
                            <span>Simulate</span>
                        </button>
                        <button class="btn btn-success" id="reengineerBtn">
                            <i class="fas fa-bolt"></i>
                            <span>Reengineer</span>
                        </button>
                    </div>
                </div>
                <div class="process-canvas" id="processCanvas">
                    <!-- Process Nodes -->
                    <div class="process-node start" style="top: 50px; left: 5%;">
                        <div class="node-title">Receive Order</div>
                        <div class="node-text">Order intake process</div>
                        <div class="node-badge">1</div>
                    </div>
                    
                    <div class="process-node decision" style="top: 50px; left: 35%;">
                        <div class="node-text">Is it valid?</div>
                        <div class="node-badge">2</div>
                    </div>
                    
                    <div class="process-node action" style="top: 50px; left: 65%;">
                        <div class="node-title">Fulfill Order</div>
                        <div class="node-text">Process and ship</div>
                        <div class="node-badge">3</div>
                    </div>
                    
                    <div class="process-node end" style="top: 200px; left: 35%;">
                        <div class="node-title">Reject</div>
                        <div class="node-text">Invalid order</div>
                        <div class="node-badge">4</div>
                    </div>
                    
                    <!-- Connectors -->
                    <div class="connector horizontal" style="top: 75px; left: 20%; width: 15%;"></div>
                    <div class="connector-arrow" style="top: 71px; left: 34%;"></div>
                    
                    <div class="connector horizontal" style="top: 75px; left: 50%; width: 15%;"></div>
                    <div class="connector-arrow" style="top: 71px; left: 64%;"></div>
                    
                    <div class="connector vertical" style="top: 75px; left: 42%; height: 150px;"></div>
                    <div class="connector horizontal" style="top: 225px; left: 42%; width: 8%;"></div>
                    <div class="connector-arrow" style="top: 221px; left: 49%; transform: rotate(90deg);"></div>
                </div>
            </div>
            
            <!-- Analysis Panel -->
            <div class="analysis-panel">
                <div class="panel-header">
                    <div class="panel-title">PROCESS ANALYSIS & OPTIMIZATION</div>
                    <div class="panel-tabs">
                        <div class="panel-tab active">Current Process</div>
                        <div class="panel-tab">Optimized Process</div>
                        <div class="panel-tab">Bottlenecks</div>
                    </div>
                </div>
                <div class="panel-content">
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">10 Days</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">$45.10</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">Process Cost</span>
                            <span class="metric-value">$45.10</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Cycle Time</span>
                            <span class="metric-value">10 Days</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Throughput</span>
                            <span class="metric-value">42 orders/day</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Error Rate</span>
                            <span class="metric-value">3.2%</span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Identified Bottlenecks</div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Manual Order Validation</div>
                        <div class="bottleneck-desc">Step 2 requires manual review of all orders, adding 2 days to cycle time</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Inventory System Integration</div>
                        <div class="bottleneck-desc">Step 3 requires manual checks across multiple systems</div>
                    </div>
                    
                    <div id="optimizationResults" style="display: none;">
                        <div class="simulation-results">
                            <div class="results-title">Reengineering Results</div>
                            <div class="result-item">
                                <span>Process Cycle Time:</span>
                                <span class="result-improvement">Reduced from 10 days to 5 days</span>
                            </div>
                            <div class="result-item">
                                <span>Process Cost:</span>
                                <span class="result-improvement">Reduced from $45.10 to $28.75</span>
                            </div>
                            <div class="result-item">
                                <span>Throughput:</span>
                                <span class="result-improvement">Increased from 42 to 68 orders/day</span>
                            </div>
                            <div class="result-item">
                                <span>Error Rate:</span>
                                <span class="result-improvement">Reduced from 3.2% to 1.1%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-circle text-success"></i>
                Status: Ready
            </div>
            <div class="status-item">
                <i class="fas fa-folder"></i>
                Project: Order_Processing_Reengineered.bpr
            </div>
            <div class="status-item">
                <i class="fas fa-search"></i>
                Zoom: 100%
            </div>
            <div class="status-item" style="margin-left: auto;">
                <i class="fas fa-lightbulb"></i>
                Tip: Click "Reengineer" to optimize this process automatically
            </div>
        </div>
    </div>

    <script>
        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navMenu = document.getElementById('navMenu');
        
        mobileMenuBtn.addEventListener('click', function() {
            navMenu.classList.toggle('active');
        });
        
        // Mobile dropdown functionality
        document.querySelectorAll('.nav-item.has-dropdown').forEach(item => {
            item.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    this.classList.toggle('active');
                }
            });
        });
        
        // Make process nodes draggable
        document.querySelectorAll('.process-node').forEach(node => {
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;
            
            node.addEventListener("mousedown", dragStart);
            node.addEventListener("touchstart", dragStart);
            document.addEventListener("mousemove", drag);
            document.addEventListener("touchmove", drag);
            document.addEventListener("mouseup", dragEnd);
            document.addEventListener("touchend", dragEnd);
            
            function dragStart(e) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                
                if (e.target === node || node.contains(e.target)) {
                    isDragging = true;
                    node.style.zIndex = "1000";
                    node.classList.add('pulse');
                }
            }
            
            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }
                    
                    xOffset = currentX;
                    yOffset = currentY;
                    
                    setTranslate(currentX, currentY, node);
                }
            }
            
            function setTranslate(xPos, yPos, el) {
                const rect = el.getBoundingClientRect();
                const canvasRect = document.getElementById('processCanvas').getBoundingClientRect();
                
                // Calculate new position
                const currentLeft = parseInt(el.style.left || 0);
                const currentTop = parseInt(el.style.top || 0);
                
                const newX = currentLeft + (xPos / canvasRect.width * 100);
                const newY = currentTop + (yPos / canvasRect.height * 100);
                
                // Keep node within canvas bounds
                if (newX >= 0 && newX <= 85 && newY >= 0 && newY <= 85) {
                    el.style.left = newX + '%';
                    el.style.top = newY + '%';
                }
            }
            
            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                
                isDragging = false;
                node.style.zIndex = "10";
                node.classList.remove('pulse');
            }
        });
        
        // Tab switching functionality
        document.querySelectorAll('.panel-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.panel-tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Update panel content based on active tab
                updatePanelContent(this.textContent);
            });
        });
        
        function updatePanelContent(tabName) {
            const panelContent = document.querySelector('.panel-content');
            if (tabName === 'Current Process') {
                panelContent.innerHTML = `
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">10 Days</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">$45.10</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">Process Cost</span>
                            <span class="metric-value">$45.10</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Cycle Time</span>
                            <span class="metric-value">10 Days</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Throughput</span>
                            <span class="metric-value">42 orders/day</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Error Rate</span>
                            <span class="metric-value">3.2%</span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Identified Bottlenecks</div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Manual Order Validation</div>
                        <div class="bottleneck-desc">Step 2 requires manual review of all orders, adding 2 days to cycle time</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Inventory System Integration</div>
                        <div class="bottleneck-desc">Step 3 requires manual checks across multiple systems</div>
                    </div>
                    
                    <div id="optimizationResults" style="display: none;">
                        <div class="simulation-results">
                            <div class="results-title">Reengineering Results</div>
                            <div class="result-item">
                                <span>Process Cycle Time:</span>
                                <span class="result-improvement">Reduced from 10 days to 5 days</span>
                            </div>
                            <div class="result-item">
                                <span>Process Cost:</span>
                                <span class="result-improvement">Reduced from $45.10 to $28.75</span>
                            </div>
                            <div class="result-item">
                                <span>Throughput:</span>
                                <span class="result-improvement">Increased from 42 to 68 orders/day</span>
                            </div>
                            <div class="result-item">
                                <span>Error Rate:</span>
                                <span class="result-improvement">Reduced from 3.2% to 1.1%</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (tabName === 'Optimized Process') {
                panelContent.innerHTML = `
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">5 Days</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">$28.75</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Optimized Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">Process Cost</span>
                            <span class="metric-value">$28.75 <span style="color: var(--success);">(-36%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Cycle Time</span>
                            <span class="metric-value">5 Days <span style="color: var(--success);">(-50%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Throughput</span>
                            <span class="metric-value">68 orders/day <span style="color: var(--success);">(+62%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Error Rate</span>
                            <span class="metric-value">1.1% <span style="color: var(--success);">(-66%)</span></span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Improvements Applied</div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Automated Validation</div>
                        <div class="improvement-desc">Step 2 now uses AI-based validation, reducing manual work by 80%</div>
                    </div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Integrated Systems</div>
                        <div class="improvement-desc">Step 3 now uses a unified inventory system with real-time updates</div>
                    </div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Parallel Processing</div>
                        <div class="improvement-desc">Multiple steps now run concurrently instead of sequentially</div>
                    </div>
                `;
            } else if (tabName === 'Bottlenecks') {
                panelContent.innerHTML = `
                    <div class="panel-title">Process Bottlenecks</div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Manual Order Validation (Step 2)</div>
                        <div class="bottleneck-desc">Manual validation process adds 2 days to cycle time. 35% of orders require manual review.</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Inventory Check (Step 3)</div>
                        <div class="bottleneck-desc">Cross-system inventory verification causes 1.5 days delay. System integration issues identified.</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Approval Workflow</div>
                        <div class="bottleneck-desc">Multi-level approval for orders over $500 adds 1.2 days to process time.</div>
                    </div>
                    
                    <div class="panel-title" style="margin-top: 25px;">Optimization Suggestions</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">Automate validation</span>
                            <span class="metric-value">Save 1.8 days</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Improve system integration</span>
                            <span class="metric-value">Save 1.2 days</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">Streamline approval</span>
                            <span class="metric-value">Save 0.8 days</span>
                        </li>
                    </ul>
                `;
            }
        }
        
        // Reengineer button functionality
        document.getElementById('reengineerBtn').addEventListener('click', function() {
            const buttons = document.querySelectorAll('.canvas-actions .btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            this.innerHTML = '<i class="fas fa-cog fa-spin"></i> <span>Reengineering...</span>';
            
            // Simulate processing delay
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> <span>Reengineered!</span>';
                this.style.backgroundColor = 'var(--success)';
                this.style.borderColor = 'var(--success)';
                
                // Show optimization results
                document.getElementById('optimizationResults').style.display = 'block';
                
                // Switch to Optimized Process tab
                document.querySelectorAll('.panel-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.textContent === 'Optimized Process') {
                        tab.classList.add('active');
                    }
                });
                
                // Update panel content to show optimized process
                updatePanelContent('Optimized Process');
                
                // Re-enable buttons after a delay
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                    });
                    this.innerHTML = '<i class="fas fa-bolt"></i> <span>Reengineer</span>';
                    this.style.backgroundColor = '';
                    this.style.borderColor = '';
                }, 3000);
            }, 3000);
        });
        
        // Simulate button functionality
        document.getElementById('simulateBtn').addEventListener('click', function() {
            const buttons = document.querySelectorAll('.canvas-actions .btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Simulating...</span>';
            
            // Simulate processing delay
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> <span>Simulation Complete</span>';
                this.style.backgroundColor = 'var(--success)';
                this.style.borderColor = 'var(--success)';
                
                // Re-enable buttons after a delay
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                    });
                    this.innerHTML = '<i class="fas fa-play"></i> <span>Simulate</span>';
                    this.style.backgroundColor = '';
                    this.style.borderColor = '';
                }, 2000);
            }, 3000);
        });
    </script>
</body>
</html>
