<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bahrain Process Reengineering System | Optimize Your Business Processes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --primary-light: #4895ef;
            --accent: #f72585;
            --accent-dark: #b5179e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #adb5bd;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #f94144;
            --sidebar-bg: #2d3748;
            --canvas-bg: #f7fafc;
            --nav-height: 60px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
            overflow: hidden;
        }
        
        .container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }
        
        /* Top Navigation */
        .top-nav {
            height: var(--nav-height);
            background-color: var(--primary-dark);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            justify-content: space-between;
        }
        
        .nav-left {
            display: flex;
            align-items: center;
        }
        
        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            margin-right: 30px;
        }
        
        .logo i {
            margin-right: 10px;
            color: var(--accent);
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            height: 100%;
        }
        
        .nav-item {
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
            padding: 0 15px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item.has-dropdown::after {
            content: "▾";
            margin-left: 8px;
            font-size: 1.2rem; /* Increased dropdown arrow size */
            color: var(--accent);
        }
        
        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            color: var(--dark);
            min-width: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 0 0 5px 5px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .nav-item:hover .dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .dropdown-item:hover {
            background-color: #f5f7fb;
        }
        
        .dropdown-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            color: var(--primary);
        }
        
        .divider {
            height: 1px;
            background-color: #e2e8f0;
            margin: 5px 0;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .bahrain-flag {
            display: flex;
            align-items: center;
            margin-left: 30px;
            font-size: 1.1rem;
            color: white;
            font-weight: 600;
        }
        
        .dark-mode-toggle {
            display: flex;
            align-items: center;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--accent);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        /* Canvas Area */
        .canvas-container {
            flex: 1;
            background-color: var(--canvas-bg);
            padding: 20px;
            overflow: auto;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .canvas-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .canvas-title {
            font-size: 1.2rem;
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .canvas-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 15px;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            transition: all 0.3s;
            height: 36px;
            color: var(--dark); /* Added to fix faded text */
        }
        
        .btn:hover {
            background-color: #f8f9fa;
            border-color: var(--primary-light);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #3aa8d0;
        }
        
        .btn-help {
            background-color: var(--warning);
            color: white;
            border-color: var(--warning);
        }
        
        .btn-help:hover {
            background-color: #e4850e;
        }
        
        .process-canvas {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            flex: 1;
            padding: 30px;
            position: relative;
            overflow: auto;
            min-height: 500px;
        }
        
        /* Process Nodes */
        .process-node {
            position: absolute;
            width: 160px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            cursor: move;
            border-left: 4px solid transparent;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .process-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .process-node.start {
            border-left-color: var(--success);
        }
        
        .process-node.decision {
            border-left-color: var(--accent);
            width: 140px;
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            padding: 15px;
        }
        
        .process-node.decision .node-text {
            font-size: 0.85rem;
            line-height: 1.3;
            text-align: center;
            word-wrap: break-word;
            max-width: 100%;
        }
        
        .process-node.action {
            border-left-color: var(--primary);
        }
        
        .process-node.end {
            border-left-color: var(--gray);
        }
        
        .node-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-dark);
        }
        
        .node-text {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .node-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--accent);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* Connectors */
        .connector {
            position: absolute;
            background-color: #718096;
            z-index: 1;
        }
        
        .connector.horizontal {
            height: 2px;
        }
        
        .connector.vertical {
            width: 2px;
        }
        
        .connector-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #718096;
            z-index: 2;
        }
        
        /* Analysis Panel */
        .analysis-panel {
            width: 350px;
            background-color: white;
            border-left: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .panel-header {
            padding: 20px 20px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .panel-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .panel-tabs {
            display: flex;
            margin-bottom: 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .panel-tab {
            padding: 12px 15px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }
        
        .panel-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .kpi-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .kpi-card {
            background-color: var(--light);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .kpi-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .kpi-label {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .metrics-list {
            list-style: none;
            margin-bottom: 25px;
        }
        
        .metric-item {
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .metric-label {
            color: var(--gray);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .metric-value {
            font-weight: 600;
            color: var(--dark);
        }
        
        .info-icon {
            color: var(--primary);
            cursor: help;
            position: relative;
        }
        
        .info-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--dark);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            width: 200px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 100;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .info-icon:hover .info-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
        }
        
        .bottleneck-item {
            padding: 15px;
            background-color: #fff5f5;
            border-left: 4px solid var(--danger);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .bottleneck-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .bottleneck-desc {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .improvement-card {
            padding: 15px;
            background-color: #f0f9ff;
            border-left: 4px solid var(--success);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .improvement-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .improvement-desc {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Status Bar */
        .status-bar {
            height: 30px;
            background-color: var(--primary-dark);
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            font-size: 0.8rem;
        }
        
        .status-item {
            margin-right: 20px;
            display: flex;
            align-items: center;
        }
        
        .status-item i {
            margin-right: 5px;
            font-size: 0.7rem;
        }
        
        /* Mobile Styles */
        @media (max-width: 992px) {
            .logo {
                font-size: 1.1rem;
                margin-right: 15px;
            }
            
            .nav-item {
                padding: 0 10px;
                font-size: 0.9rem;
            }
            
            .analysis-panel {
                width: 300px;
            }
            
            .bahrain-flag {
                margin-left: 15px;
                font-size: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .top-nav {
                padding: 0 15px;
            }
            
            .logo span {
                display: none;
            }
            
            .logo {
                margin-right: 10px;
            }
            
            .mobile-menu-btn {
                display: block;
                margin-right: 15px;
            }
            
            .nav-menu {
                position: fixed;
                top: var(--nav-height);
                left: 0;
                width: 100%;
                background-color: var(--primary-dark);
                flex-direction: column;
                height: auto;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s;
                z-index: 1000;
            }
            
            .nav-menu.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            .nav-item {
                height: auto;
                padding: 15px 20px;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .nav-item.has-dropdown::after {
                margin-left: auto;
            }
            
            .dropdown {
                position: static;
                opacity: 1;
                visibility: visible;
                transform: none;
                box-shadow: none;
                background-color: rgba(0,0,0,0.2);
                color: white;
                display: none;
            }
            
            .dropdown-item {
                color: white;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .dropdown-item:hover {
                background-color: rgba(255,255,255,0.1);
            }
            
            .dropdown-item i {
                color: white;
            }
            
            .nav-item.active .dropdown {
                display: block;
            }
            
            .user-profile span {
                display: none;
            }
            
            .bahrain-flag {
                display: none;
            }
            
            .dark-mode-toggle {
                margin-right: 10px;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .analysis-panel {
                width: 100%;
                height: 40vh;
                border-left: none;
                border-top: 1px solid #e2e8f0;
            }
            
            .canvas-container {
                height: 60vh;
            }
            
            .canvas-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .canvas-actions {
                width: 100%;
                justify-content: space-between;
                flex-wrap: wrap;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .btn span {
                display: none;
            }
            
            .status-bar {
                flex-wrap: wrap;
                height: auto;
                padding: 8px 15px;
            }
            
            .status-item {
                margin-right: 15px;
                margin-bottom: 5px;
            }
            
            .process-node {
                width: 140px;
                padding: 12px;
            }
            
            .process-node.decision {
                width: 120px;
                height: 120px;
            }
            
            .node-title {
                font-size: 0.9rem;
            }
            
            .node-text {
                font-size: 0.8rem;
            }
            
            /* Mobile-specific process layout */
            .mobile-layout .process-node {
                position: relative !important;
                top: auto !important;
                left: auto !important;
                margin-bottom: 20px;
                width: 100%;
            }
            
            .mobile-layout .process-canvas {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
        }
        
        @media (max-width: 480px) {
            .logo {
                font-size: 1rem;
            }
            
            .canvas-title {
                font-size: 1rem;
            }
            
            .btn {
                padding: 6px 10px;
            }
            
            .process-node {
                width: 120px;
                padding: 10px;
            }
            
            .process-node.decision {
                width: 100px;
                height: 100px;
            }
            
            .node-title {
                font-size: 0.8rem;
            }
            
            .node-text {
                font-size: 0.7rem;
            }
            
            .kpi-cards {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .panel-content {
                padding: 15px;
            }
        }
        
        /* Animation for node connections */
        @keyframes pulse {
            0% { opacity: 0.4; }
            50% { opacity: 1; }
            100% { opacity: 0.4; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .simulation-results {
            background-color: #f0f9ff;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--success);
        }
        
        .results-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-dark);
            font-size: 1.1rem;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .result-improvement {
            color: var(--success);
            font-weight: 600;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.3rem;
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-control.gray {
            background-color: #f8f9fa;
            color: var(--gray);
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        /* Dark mode styles */
        body.dark-mode {
            background-color: #1a202c;
            color: #e2e8f0;
        }
        
        body.dark-mode .top-nav {
            background-color: #2d3748;
        }
        
        body.dark-mode .canvas-container {
            background-color: #1a202c;
        }
        
        body.dark-mode .process-canvas,
        body.dark-mode .kpi-card,
        body.dark-mode .process-node {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        
        body.dark-mode .analysis-panel {
            background-color: #2d3748;
            border-left-color: #4a5568;
        }
        
        body.dark-mode .panel-header {
            border-bottom-color: #4a5568;
        }
        
        body.dark-mode .canvas-title {
            color: #90cdf4;
            font-weight: 700;
        }
        
        body.dark-mode .panel-title,
        body.dark-mode .node-title,
        body.dark-mode .metric-value {
            color: #e2e8f0;
        }
        
        body.dark-mode .node-text,
        body.dark-mode .metric-label,
        body.dark-mode .kpi-label,
        body.dark-mode .bottleneck-desc,
        body.dark-mode .improvement-desc {
            color: #a0aec0;
        }
        
        body.dark-mode .btn {
            background-color: #4a5568;
            color: #e2e8f0;
            border-color: #4a5568;
        }
        
        body.dark-mode .btn:hover {
            background-color: #2d3748;
        }
        
        body.dark-mode .modal-content {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        
        body.dark-mode .modal-title {
            color: #e2e8f0;
        }
        
        body.dark-mode .form-control {
            background-color: #4a5568;
            border-color: #4a5568;
            color: #e2e8f0;
        }
        
        body.dark-mode .form-control.gray {
            background-color: #4a5568;
            color: #a0aec0;
        }
        
        body.dark-mode .form-label {
            color: #e2e8f0;
        }
        
        body.dark-mode .dropdown {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        
        body.dark-mode .dropdown-item {
            color: #e2e8f0;
            border-bottom-color: #4a5568;
        }
        
        body.dark-mode .dropdown-item:hover {
            background-color: #4a5568;
        }
        
        body.dark-mode .dropdown-item i {
            color: #e2e8f0;
        }
        
        body.dark-mode .divider {
            background-color: #4a5568;
        }
        
        /* Dark mode for bottleneck and improvement cards */
        body.dark-mode .bottleneck-item {
            background-color: #4a5568;
            border-left-color: var(--danger);
        }
        
        body.dark-mode .bottleneck-title {
            color: #e2e8f0;
        }
        
        body.dark-mode .bottleneck-desc {
            color: #a0aec0;
        }
        
        body.dark-mode .improvement-card {
            background-color: #4a5568;
            border-left-color: var(--success);
        }
        
        body.dark-mode .improvement-title {
            color: #e2e8f0;
        }
        
        body.dark-mode .improvement-desc {
            color: #a0aec0;
        }
        
        /* Share dropdown */
        .share-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 180px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 5px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .share-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .share-dropdown .dropdown-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .share-dropdown .dropdown-item:hover {
            background-color: #f5f7fb;
        }
        
        .share-dropdown .dropdown-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            color: var(--primary);
        }
        
        /* Fix for share button size and alignment */
        #shareContainer {
            position: relative;
            display: inline-block;
        }
        
        #shareContainer .btn {
            padding: 8px 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 36px;
        }
        
        /* Fix for arrows */
        .connector-arrow {
            border-top-color: #718096;
        }
        
        .connector {
            background-color: #718096;
        }
        
        /* File dropdown icon */
        .nav-item.has-dropdown i {
            margin-right: 8px;
            color: var(--accent);
        }
        
        /* Button active state */
        .btn:active {
            transform: translateY(1px);
        }
        
        /* Remove duplicate share button */
        #duplicateShareButton {
            display: none;
        }
        
        /* Fix for faded buttons in light mode */
        .btn:not(.btn-primary):not(.btn-success):not(.btn-help) {
            color: var(--dark);
            background-color: white;
            border: 1px solid #e2e8f0;
        }
        
        /* Dark mode styles for share dropdown */
        body.dark-mode .share-dropdown {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        
        body.dark-mode .share-dropdown .dropdown-item {
            color: #e2e8f0;
            border-bottom-color: #4a5568;
        }
        
        body.dark-mode .share-dropdown .dropdown-item:hover {
            background-color: #4a5568;
        }
        
        body.dark-mode .share-dropdown .dropdown-item i {
            color: #e2e8f0;
        }
        
        body.dark-mode .share-dropdown .divider {
            background-color: #4a5568;
        }
        
        /* Share button dropdown arrow fix */
        #shareContainer::after {
            content: "▾";
            margin-left: 8px;
            font-size: 1.2rem;
            color: var(--accent);
            display: inline-block;
            line-height: 1;
        }
        
        /* Adjust canvas actions to better accommodate share button */
        .canvas-actions {
            gap: 8px;
        }
    </style>
</head>
<body>
    <!-- Help Modal -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Request Expert Help</div>
                <button class="close-modal" id="closeHelpModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Our process reengineering experts can help you optimize this workflow. Please provide details about your process and specific challenges.</p>
                <div class="form-group">
                    <label class="form-label" for="processName">Process Name</label>
                    <input type="text" class="form-control gray" id="processName" value="Order Processing" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label" for="helpDetails">Specific Challenges & Goals</label>
                    <textarea class="form-control" id="helpDetails" placeholder="Describe the challenges you're facing and what you hope to achieve with process reengineering..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="submitHelpRequest">
                    <i class="fas fa-paper-plane"></i>
                    Submit Request
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-left">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">
                    <i class="fas fa-project-diagram"></i>
                    <span>Bahrain Process Reengineering System</span>
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item has-dropdown">
                        <i class="fas fa-folder"></i>
                        File
                        <div class="dropdown">
                            <div class="dropdown-item">
                                <i class="fas fa-file-import"></i>
                                Import Process
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-file-export"></i>
                                Export Process
                            </div>
                            <div class="divider"></div>
                            <div class="dropdown-item">
                                <i class="fas fa-file-import"></i>
                                Import from Text
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-database"></i>
                                Import from ERP
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-cloud-download-alt"></i>
                                Import from Cloud
                            </div>
                            <div class="divider"></div>
                            <div class="dropdown-item">
                                <i class="fas fa-folder-open"></i>
                                Open Project...
                            </div>
                            <div class="dropdown-item">
                                <i class="fas fa-save"></i>
                                Save Project
                            </div>
                        </div>
                    </li>
                </ul>
                <div class="bahrain-flag">
                    <span>Kingdom of Bahrain</span>
                </div>
            </div>
            <div class="nav-right">
                <div class="user-profile">
                    <div class="dark-mode-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="avatar">AQ</div>
                    <span>Amro Qasim</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Canvas Area -->
            <div class="canvas-container">
                <div class="canvas-header">
                    <div class="canvas-title">Order Processing</div>
                    <div class="canvas-actions">
                        <button class="btn">
                            <i class="fas fa-undo"></i>
                            <span>Undo</span>
                        </button>
                        <button class="btn">
                            <i class="fas fa-redo"></i>
                            <span>Redo</span>
                        </button>
                        <button class="btn btn-primary" id="simulateBtn">
                            <i class="fas fa-play"></i>
                            <span>Simulate</span>
                        </button>
                        <button class="btn btn-success" id="reengineerBtn">
                            <i class="fas fa-bolt"></i>
                            <span>Reengineer</span>
                        </button>
                        <div class="nav-item has-dropdown" id="shareContainer" style="position: relative; display: inline-block;">
                            <button class="btn">
                                <i class="fas fa-share-alt"></i>
                                <span>Share</span>
                            </button>
                            <div class="share-dropdown">
                                <div class="dropdown-item">
                                    <i class="fas fa-link"></i>
                                    Share via Link
                                </div>
                                <div class="divider"></div>
                                <div class="dropdown-item">
                                    <i class="fas fa-file-pdf"></i>
                                    Export as PDF
                                </div>
                                <div class="dropdown-item">
                                    <i class="fas fa-image"></i>
                                    Export as PNG
                                </div>
                                <div class="dropdown-item">
                                    <i class="fas fa-project-diagram"></i>
                                    Export as BPMN
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-help" id="helpBtn">
                            <i class="fas fa-question-circle"></i>
                            <span>Help</span>
                        </button>
                    </div>
                </div>
                <div class="process-canvas" id="processCanvas">
                    <!-- Process Nodes will be dynamically generated -->
                </div>
            </div>
            
            <!-- Analysis Panel -->
            <div class="analysis-panel">
                <div class="panel-header">
                    <div class="panel-title">Process Analysis & Optimization Dashboard</div>
                    <div class="panel-tabs">
                        <div class="panel-tab active">Current Process</div>
                        <div class="panel-tab">Optimized Process</div>
                    </div>
                </div>
                <div class="panel-content">
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">12 Days</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">BHD 22.15</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">
                                Process Cost
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Total cost to complete one instance of this process</div>
                                </div>
                            </span>
                            <span class="metric-value">BHD 22.15</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Cycle Time
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Average time from start to completion of the process</div>
                                </div>
                            </span>
                            <span class="metric-value">12 Days</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Throughput
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Number of process instances completed per day</div>
                                </div>
                            </span>
                            <span class="metric-value">35 orders/day</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Error Rate
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Percentage of process instances with errors or rework</div>
                                </div>
                            </span>
                            <span class="metric-value">4.8%</span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Identified Bottlenecks</div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Manual Order Validation</div>
                        <div class="bottleneck-desc">Step 2 requires manual review of all orders, adding 3 days to cycle time</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Inventory System Integration</div>
                        <div class="bottleneck-desc">Step 3 requires manual checks across multiple systems</div>
                    </div>
                    
                    <div id="optimizationResults" style="display: none;">
                        <div class="simulation-results">
                            <div class="results-title">Reengineering Results</div>
                            <div class="result-item">
                                <span>Process Cycle Time:</span>
                                <span class="result-improvement">Reduced from 12 days to 5 days</span>
                            </div>
                            <div class="result-item">
                                <span>Process Cost:</span>
                                <span class="result-improvement">Reduced from BHD 22.15 to BHD 12.20</span>
                            </div>
                            <div class="result-item">
                                <span>Throughput:</span>
                                <span class="result-improvement">Increased from 35 to 72 orders/day</span>
                            </div>
                            <div class="result-item">
                                <span>Error Rate:</span>
                                <span class="result-improvement">Reduced from 4.8% to 1.2%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-circle text-success"></i>
                Status: Ready
            </div>
            <div class="status-item">
                <i class="fas fa-folder"></i>
                Project: Order_Processing_Reengineered.bpr
            </div>
            <div class="status-item">
                <i class="fas fa-search"></i>
                Zoom: 100%
            </div>
            <div class="status-item" style="margin-left: auto;">
                <i class="fas fa-lightbulb"></i>
                Tip: Click "Reengineer" to optimize this process automatically
            </div>
        </div>
    </div>

    <script>
        // Process data for initial and optimized states
        const processStates = {
            initial: {
                nodes: [
                    { id: 1, type: 'start', title: 'Receive Order', text: 'Order intake process', x: 5, y: 10 },
                    { id: 2, type: 'decision', title: 'Validation', text: 'Manual review needed?', x: 35, y: 10 },
                    { id: 3, type: 'action', title: 'Fulfill Order', text: 'Process and ship', x: 65, y: 10 },
                    { id: 4, type: 'end', title: 'Reject', text: 'Invalid order', x: 35, y: 40 }
                ],
                connectors: [
                    // Horizontal from node 1 to node 2
                    { from: 1, to: 2, type: 'horizontal', x1: 16, y1: 17.5, x2: 35, length: 19 },
                    // Horizontal from node 2 to node 3
                    { from: 2, to: 3, type: 'horizontal', x1: 49, y1: 17.5, x2: 65, length: 16 },
                    // Vertical from node 2 to node 4
                    { from: 2, to: 4, type: 'vertical', x1: 42, y1: 24, x2: 40, length: 16 }
                ],
                metrics: {
                    cycleTime: '12 Days',
                    cost: 'BHD 22.15',
                    throughput: '35 orders/day',
                    errorRate: '4.8%'
                }
            },
            optimized: {
                nodes: [
                    { id: 1, type: 'start', title: 'Receive Order', text: 'Automated intake', x: 5, y: 10 },
                    { id: 2, type: 'action', title: 'Auto-Validation', text: 'AI-powered check', x: 25, y: 10 },
                    { id: 3, type: 'decision', title: 'Complex Cases', text: 'Needs review?', x: 45, y: 10 },
                    { id: 4, type: 'action', title: 'Quick Review', text: 'Expert assessment', x: 30, y: 40 },
                    { id: 5, type: 'action', title: 'Fulfill Order', text: 'Automated process', x: 65, y: 10 },
                    { id: 6, type: 'end', title: 'Reject', text: 'Invalid order', x: 65, y: 40 }
                ],
                connectors: [
                    // Horizontal from node 1 to node 2
                    { from: 1, to: 2, type: 'horizontal', x1: 16, y1: 17.5, x2: 25, length: 9 },
                    // Horizontal from node 2 to node 3
                    { from: 2, to: 3, type: 'horizontal', x1: 39, y1: 17.5, x2: 45, length: 6 },
                    // Horizontal from node 3 to node 5
                    { from: 3, to: 5, type: 'horizontal', x1: 59, y1: 17.5, x2: 65, length: 6 },
                    // Vertical from node 3 to node 4
                    { from: 3, to: 4, type: 'vertical', x1: 47, y1: 24, x2: 40, length: 16 },
                    // Horizontal from node 4 to node 5
                    { from: 4, to: 5, type: 'horizontal', x1: 44, y1: 42.5, x2: 65, length: 21 },
                    // Vertical from node 4 to node 6
                    { from: 4, to: 6, type: 'vertical', x1: 67, y1: 42.5, x2: 40, length: -2.5 }
                ],
                metrics: {
                    cycleTime: '5 Days',
                    cost: 'BHD 12.20',
                    throughput: '72 orders/day',
                    errorRate: '1.2%'
                }
            }
        };

        // Mobile-specific process layouts
        const mobileProcessStates = {
            initial: {
                nodes: [
                    { id: 1, type: 'start', title: 'Receive Order', text: 'Order intake process', x: 5, y: 5 },
                    { id: 2, type: 'decision', title: 'Validation', text: 'Manual review needed?', x: 5, y: 25 },
                    { id: 3, type: 'action', title: 'Fulfill Order', text: 'Process and ship', x: 5, y: 45 },
                    { id: 4, type: 'end', title: 'Reject', text: 'Invalid order', x: 5, y: 65 }
                ],
                connectors: [
                    // Vertical from node 1 to node 2
                    { from: 1, to: 2, type: 'vertical', x1: 12, y1: 15, x2: 25, length: 10 },
                    // Vertical from node 2 to node 3
                    { from: 2, to: 3, type: 'vertical', x1: 12, y1: 40, x2: 45, length: 5 },
                    // Vertical from node 2 to node 4
                    { from: 2, to: 4, type: 'vertical', x1: 8, y1: 40, x2: 65, length: 25 }
                ],
                metrics: {
                    cycleTime: '12 Days',
                    cost: 'BHD 22.15',
                    throughput: '35 orders/day',
                    errorRate: '4.8%'
                }
            },
            optimized: {
                nodes: [
                    { id: 1, type: 'start', title: 'Receive Order', text: 'Automated intake', x: 5, y: 5 },
                    { id: 2, type: 'action', title: 'Auto-Validation', text: 'AI-powered check', x: 5, y: 20 },
                    { id: 3, type: 'decision', title: 'Complex Cases', text: 'Needs review?', x: 5, y: 35 },
                    { id: 4, type: 'action', title: 'Quick Review', text: 'Expert assessment', x: 5, y: 50 },
                    { id: 5, type: 'action', title: 'Fulfill Order', text: 'Automated process', x: 5, y: 65 },
                    { id: 6, type: 'end', title: 'Reject', text: 'Invalid order', x: 5, y: 80 }
                ],
                connectors: [
                    // Vertical from node 1 to node 2
                    { from: 1, to: 2, type: 'vertical', x1: 12, y1: 15, x2: 20, length: 5 },
                    // Vertical from node 2 to node 3
                    { from: 2, to: 3, type: 'vertical', x1: 12, y1: 30, x2: 35, length: 5 },
                    // Vertical from node 3 to node 5
                    { from: 3, to: 5, type: 'vertical', x1: 12, y1: 50, x2: 65, length: 15 },
                    // Vertical from node 3 to node 4
                    { from: 3, to: 4, type: 'vertical', x1: 8, y1: 50, x2: 50, length: 0 },
                    // Vertical from node 4 to node 5
                    { from: 4, to: 5, type: 'vertical', x1: 12, y1: 65, x2: 65, length: 0 },
                    // Vertical from node 4 to node 6
                    { from: 4, to: 6, type: 'vertical', x1: 8, y1: 65, x2: 80, length: 15 }
                ],
                metrics: {
                    cycleTime: '5 Days',
                    cost: 'BHD 12.20',
                    throughput: '72 orders/day',
                    errorRate: '1.2%'
                }
            }
        };

        let currentProcessState = 'initial';
        let isMobileView = false;

        // Function to check if we're in mobile view
        function checkMobileView() {
            isMobileView = window.innerWidth <= 768;
            return isMobileView;
        }

        // Function to render process on canvas
        function renderProcess(state) {
            const processCanvas = document.getElementById('processCanvas');
            processCanvas.innerHTML = '';
            
            // Add mobile layout class if needed
            if (isMobileView) {
                processCanvas.classList.add('mobile-layout');
            } else {
                processCanvas.classList.remove('mobile-layout');
            }
            
            const processData = isMobileView ? mobileProcessStates[state] : processStates[state];
            
            // Render nodes
            processData.nodes.forEach(node => {
                const nodeEl = document.createElement('div');
                nodeEl.className = `process-node ${node.type}`;
                if (isMobileView) {
                    nodeEl.style.top = `${node.y}%`;
                    nodeEl.style.left = `${node.x}%`;
                } else {
                    nodeEl.style.top = `${node.y}%`;
                    nodeEl.style.left = `${node.x}%`;
                }
                nodeEl.innerHTML = `
                    <div class="node-title">${node.title}</div>
                    <div class="node-text">${node.text}</div>
                    <div class="node-badge">${node.id}</div>
                `;
                processCanvas.appendChild(nodeEl);
            });
            
            // Render connectors
            processData.connectors.forEach(connector => {
                if (connector.type === 'horizontal') {
                    const connectorEl = document.createElement('div');
                    connectorEl.className = 'connector horizontal';
                    connectorEl.style.top = `${connector.y1}%`;
                    connectorEl.style.left = `${connector.x1}%`;
                    connectorEl.style.width = `${connector.length}%`;
                    processCanvas.appendChild(connectorEl);
                    
                    const arrowEl = document.createElement('div');
                    arrowEl.className = 'connector-arrow';
                    arrowEl.style.top = `${connector.y1 - 0.5}%`;
                    arrowEl.style.left = `${connector.x2}%`;
                    processCanvas.appendChild(arrowEl);
                } else if (connector.type === 'vertical') {
                    const connectorEl = document.createElement('div');
                    connectorEl.className = 'connector vertical';
                    connectorEl.style.top = `${connector.y1}%`;
                    connectorEl.style.left = `${connector.x1}%`;
                    connectorEl.style.height = `${connector.length}%`;
                    processCanvas.appendChild(connectorEl);
                    
                    const arrowEl = document.createElement('div');
                    arrowEl.className = 'connector-arrow';
                    arrowEl.style.top = `${connector.y2}%`;
                    arrowEl.style.left = `${connector.x1 - 0.5}%`;
                    arrowEl.style.transform = 'rotate(90deg)';
                    processCanvas.appendChild(arrowEl);
                }
            });
            
            // Reattach drag events to new nodes (only for desktop)
            if (!isMobileView) {
                attachDragEvents();
            }
        }

        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navMenu = document.getElementById('navMenu');
        
        mobileMenuBtn.addEventListener('click', function() {
            navMenu.classList.toggle('active');
        });
        
        // Mobile dropdown functionality
        document.querySelectorAll('.nav-item.has-dropdown').forEach(item => {
            item.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    this.classList.toggle('active');
                }
            });
        });
        
        // Share dropdown functionality
        const shareContainer = document.getElementById('shareContainer');
        const shareDropdown = shareContainer.querySelector('.share-dropdown');
        
        shareContainer.addEventListener('click', function(e) {
            if (window.innerWidth > 768) {
                e.stopPropagation();
                shareDropdown.classList.toggle('active');
            }
        });
        
        // Close share dropdown when clicking elsewhere
        document.addEventListener('click', function() {
            shareDropdown.classList.remove('active');
        });
        
        // Make process nodes draggable (desktop only)
        function attachDragEvents() {
            document.querySelectorAll('.process-node').forEach(node => {
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                node.addEventListener("mousedown", dragStart);
                document.addEventListener("mousemove", drag);
                document.addEventListener("mouseup", dragEnd);
                
                function dragStart(e) {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - initialY;
                    
                    if (e.target === node || node.contains(e.target)) {
                        isDragging = true;
                        node.style.zIndex = "1000";
                        node.classList.add('pulse');
                    }
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        setTranslate(currentX, currentY, node);
                    }
                }
                
                function setTranslate(xPos, yPos, el) {
                    const rect = el.getBoundingClientRect();
                    const canvasRect = document.getElementById('processCanvas').getBoundingClientRect();
                    
                    // Calculate new position
                    const currentLeft = parseInt(el.style.left || 0);
                    const currentTop = parseInt(el.style.top || 0);
                    
                    const newX = currentLeft + (xPos / canvasRect.width * 100);
                    const newY = currentTop + (yPos / canvasRect.height * 100);
                    
                    // Keep node within canvas bounds
                    if (newX >= 0 && newX <= 85 && newY >= 0 && newY <= 85) {
                        el.style.left = newX + '%';
                        el.style.top = newY + '%';
                    }
                }
                
                function dragEnd(e) {
                    initialX = currentX;
                    initialY = currentY;
                    
                    isDragging = false;
                    node.style.zIndex = "10";
                    node.classList.remove('pulse');
                }
            });
        }
        
        // Tab switching functionality
        document.querySelectorAll('.panel-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.panel-tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Update panel content based on active tab
                updatePanelContent(this.textContent);
            });
        });
        
        function updatePanelContent(tabName) {
            const panelContent = document.querySelector('.panel-content');
            const processData = isMobileView ? 
                mobileProcessStates[currentProcessState] : 
                processStates[currentProcessState];
            
            // Always use initial metrics for Current Process tab
            const initialProcessData = isMobileView ? 
                mobileProcessStates.initial : 
                processStates.initial;
                
            if (tabName === 'Current Process') {
                panelContent.innerHTML = `
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">${initialProcessData.metrics.cycleTime}</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">${initialProcessData.metrics.cost}</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">
                                Process Cost
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Total cost to complete one instance of this process</div>
                                </div>
                            </span>
                            <span class="metric-value">${initialProcessData.metrics.cost}</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Cycle Time
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Average time from start to completion of the process</div>
                                </div>
                            </span>
                            <span class="metric-value">${initialProcessData.metrics.cycleTime}</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Throughput
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Number of process instances completed per day</div>
                                </div>
                            </span>
                            <span class="metric-value">${initialProcessData.metrics.throughput}</span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Error Rate
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Percentage of process instances with errors or rework</div>
                                </div>
                            </span>
                            <span class="metric-value">${initialProcessData.metrics.errorRate}</span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Identified Bottlenecks</div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Manual Order Validation</div>
                        <div class="bottleneck-desc">Step 2 requires manual review of all orders, adding 3 days to cycle time</div>
                    </div>
                    
                    <div class="bottleneck-item">
                        <div class="bottleneck-title">Inventory System Integration</div>
                        <div class="bottleneck-desc">Step 3 requires manual checks across multiple systems</div>
                    </div>
                    
                    <div id="optimizationResults" style="display: none;">
                        <div class="simulation-results">
                            <div class="results-title">Reengineering Results</div>
                            <div class="result-item">
                                <span>Process Cycle Time:</span>
                                <span class="result-improvement">Reduced from 12 days to 5 days</span>
                            </div>
                            <div class="result-item">
                                <span>Process Cost:</span>
                                <span class="result-improvement">Reduced from BHD 22.15 to BHD 12.20</span>
                            </div>
                            <div class="result-item">
                                <span>Throughput:</span>
                                <span class="result-improvement">Increased from 35 to 72 orders/day</span>
                            </div>
                            <div class="result-item">
                                <span>Error Rate:</span>
                                <span class="result-improvement">Reduced from 4.8% to 1.2%</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (tabName === 'Optimized Process') {
                const optimizedData = isMobileView ? 
                    mobileProcessStates.optimized : 
                    processStates.optimized;
                panelContent.innerHTML = `
                    <div class="kpi-cards">
                        <div class="kpi-card">
                            <div class="kpi-value">${optimizedData.metrics.cycleTime}</div>
                            <div class="kpi-label">Cycle Time</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value">${optimizedData.metrics.cost}</div>
                            <div class="kpi-label">Avg. Cost</div>
                        </div>
                    </div>
                    
                    <div class="panel-title">Optimized Process Metrics</div>
                    
                    <ul class="metrics-list">
                        <li class="metric-item">
                            <span class="metric-label">
                                Process Cost
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Total cost to complete one instance of this process</div>
                                </div>
                            </span>
                            <span class="metric-value">${optimizedData.metrics.cost} <span style="color: var(--success);">(-45%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Cycle Time
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Average time from start to completion of the process</div>
                                </div>
                            </span>
                            <span class="metric-value">${optimizedData.metrics.cycleTime} <span style="color: var(--success);">(-58%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Throughput
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Number of process instances completed per day</div>
                                </div>
                            </span>
                            <span class="metric-value">${optimizedData.metrics.throughput} <span style="color: var(--success);">(+106%)</span></span>
                        </li>
                        <li class="metric-item">
                            <span class="metric-label">
                                Error Rate
                                <div class="info-icon">
                                    <i class="fas fa-info-circle"></i>
                                    <div class="info-tooltip">Percentage of process instances with errors or rework</div>
                                </div>
                            </span>
                            <span class="metric-value">${optimizedData.metrics.errorRate} <span style="color: var(--success);">(-75%)</span></span>
                        </li>
                    </ul>
                    
                    <div class="panel-title">Improvements Applied</div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Automated Validation</div>
                        <div class="improvement-desc">Step 2 now uses AI-based validation, reducing manual work by 80%</div>
                    </div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Integrated Systems</div>
                        <div class="improvement-desc">Step 3 now uses a unified inventory system with real-time updates</div>
                    </div>
                    
                    <div class="improvement-card">
                        <div class="improvement-title">Parallel Processing</div>
                        <div class="improvement-desc">Multiple steps now run concurrently instead of sequentially</div>
                    </div>
                `;
            }
        }
        
        // Reengineer button functionality
        document.getElementById('reengineerBtn').addEventListener('click', function() {
            const buttons = document.querySelectorAll('.canvas-actions .btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            this.innerHTML = '<i class="fas fa-cog fa-spin"></i> <span>Reengineering...</span>';
            
            // Simulate processing delay
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> <span>Reengineered!</span>';
                this.style.backgroundColor = 'var(--success)';
                this.style.borderColor = 'var(--success)';
                
                // Change process to optimized state
                currentProcessState = 'optimized';
                renderProcess('optimized');
                
                // Switch to Optimized Process tab
                document.querySelectorAll('.panel-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.textContent === 'Optimized Process') {
                        tab.classList.add('active');
                    }
                });
                
                // Update panel content to show optimized process
                updatePanelContent('Optimized Process');
                
                // Show optimization results in current tab
                document.getElementById('optimizationResults').style.display = 'block';
                
                // Re-enable buttons after a delay
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                    });
                    this.innerHTML = '<i class="fas fa-bolt"></i> <span>Reengineer</span>';
                    this.style.backgroundColor = '';
                    this.style.borderColor = '';
                }, 3000);
            }, 3000);
        });
        
        // Simulate button functionality
        document.getElementById('simulateBtn').addEventListener('click', function() {
            const buttons = document.querySelectorAll('.canvas-actions .btn');
            buttons.forEach(btn => {
                btn.disabled = true;
            });
            
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Simulating...</span>';
            
            // Simulate processing delay
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> <span>Simulation Complete</span>';
                this.style.backgroundColor = 'var(--success)';
                this.style.borderColor = 'var(--success)';
                
                // Re-enable buttons after a delay
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                    });
                    this.innerHTML = '<i class="fas fa-play"></i> <span>Simulate</span>';
                    this.style.backgroundColor = '';
                    this.style.borderColor = '';
                }, 2000);
            }, 3000);
        });
        
        // Help modal functionality
        const helpModal = document.getElementById('helpModal');
        const helpBtn = document.getElementById('helpBtn');
        const closeHelpModal = document.getElementById('closeHelpModal');
        const submitHelpRequest = document.getElementById('submitHelpRequest');
        
        helpBtn.addEventListener('click', function() {
            helpModal.style.display = 'flex';
        });
        
        closeHelpModal.addEventListener('click', function() {
            helpModal.style.display = 'none';
        });
        
        submitHelpRequest.addEventListener('click', function() {
            const helpDetails = document.getElementById('helpDetails').value;
            
            if (!helpDetails) {
                alert('Please describe your challenges before submitting.');
                return;
            }
            
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            this.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                alert('Your request has been submitted! An expert will contact you within 24 hours.');
                helpModal.style.display = 'none';
                this.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Request';
                this.disabled = false;
                
                // Reset form
                document.getElementById('helpDetails').value = '';
            }, 2000);
        });
        
        // Dark mode toggle functionality
        const darkModeToggle = document.getElementById('darkModeToggle');
        darkModeToggle.addEventListener('change', function() {
            document.body.classList.toggle('dark-mode', this.checked);
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === helpModal) {
                helpModal.style.display = 'none';
            }
        });
        
        // Handle window resize for responsive layout
        window.addEventListener('resize', function() {
            checkMobileView();
            renderProcess(currentProcessState);
        });
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            checkMobileView();
            renderProcess('initial');
        });
    </script>
</body>
</html>
